Training parameters:
----------
number of trainable parameters:  1034496
batch size:  5
num epochs:  200
Epoch 0/199
----------

Traceback (most recent call last):
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/driver_scratchpad.py", line 956, in <module>
    main_train(
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/driver_scratchpad.py", line 877, in main_train
    model = train_dl(
            ^^^^^^^^^
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/train.py", line 218, in train_dl
    outputs, reg_loss = model(inputs, text)
                        ^^^^^^^^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/model.py", line 162, in forward
    image_embeddings, reg_loss = self.sam_encoder(x_img)
                                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/prompt_adapted_segment_anything/modeling/image_encoder.py", line 180, in forward
    x, loss = blk(x)
              ^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/prompt_adapted_segment_anything/modeling/image_encoder.py", line 287, in forward
    x, reg_loss1 = self.attn(x)
                   ^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sarim.hashmi/anaconda3/envs/AI702/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/l/users/sarim.hashmi/for_the_little_interns/the_experiments/drive_dataset/svd_only/prompt_adapted_segment_anything/modeling/image_encoder.py", line 354, in forward
    attn = (q * self.scale) @ k.transpose(-2, -1)
           ~~~~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~~~
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 240.00 MiB. GPU 0 has a total capacity of 23.65 GiB of which 79.69 MiB is free. Process 665023 has 3.64 GiB memory in use. Process 1482752 has 5.95 GiB memory in use. Process 1732904 has 2.86 GiB memory in use. Including non-PyTorch memory, this process has 10.79 GiB memory in use. Of the allocated memory 10.14 GiB is allocated by PyTorch, and 152.49 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)